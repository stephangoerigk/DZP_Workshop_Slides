<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Einheit 1</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr. Stephan Goerigk" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/hygge.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <script src="libs/fabric/fabric.min.js"></script>
    <link href="libs/xaringanExtra-scribble/scribble.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-scribble/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#00C1BF"],"pen_size":4,"eraser_size":40,"palette":[]}) })</script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




name: Title slide
class: middle, left
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
# DZPG-Workshop - Methoden der Psychotherapieforschung

### Nachmittagssession - Innovative analysis of existing RCT data
##### 19.11.2022 | Dr. phil. Stephan Goerigk

---
class: top, left
name: Contact Slide

### Kontakt

.pull-left[
Dr. phil. Stephan Goerigk 

Psychologische Methodenlehre

Klinik für Psychiatrie und Psychotherapie

Ludwig-Maximilians-Universität

Nussbaumstraße 7 · 80336 München · 

[stephan.goerigk@med.uni-muenchen.de](mailto:stephan.goerigk@med.uni-muenchen.de)

[Publikationen](https://scholar.google.at/citations?user=nlvO-e4AAAAJ&amp;hl=de)

[Commitment to Research Transparency](http://www.researchtransparency.org)
]

.pull-right[
.center[
&lt;br&gt;&lt;br&gt;&lt;br&gt;
.bottom[![](rtransperency.png)]
]
]

---
class: top, left
### Parallelgruppen-Design

#### Gold-Standard Wirksamkeitsanalyse (Efficacy)

.center[
&lt;img src="bilder/RCT.png" width="1000px" /&gt;
]

---
class: top, left
### Parallelgruppen-Design

#### Gold-Standard Wirksamkeitsanalyse (Efficacy)

---
class: top, left
### Parallelgruppen-Design 

#### Präzisionsmedizinische Fragestellung

.center[
&lt;img src="bilder/precision.png" width="1000px" /&gt;
]

---
class: top, left
### Responderanalyse 

#### Marker für Behandlungserfolg - Klassische Explanative Ansätze der Responderanalyse

.center[
&lt;img src="bilder/mod1.png" width="400px" /&gt;
]

.pull-left[
.center[
&lt;img src="bilder/Moderation.png" width="400px" /&gt;
]
]
.pull-right[
.center[
&lt;img src="bilder/Mediation.png" width="400px" /&gt;
]
]

---
class: top, left
### Responderanalyse 

#### Marker für Behandlungserfolg - Ansätze zur Erhöhung der Präzision

.pull-left[
.center[
&lt;img src="bilder/mod3.png" width="500px" /&gt;
]
.center[
&lt;img src="bilder/mod2.png" width="500px" /&gt;
]

]
.pull-right[
**Optimierung der Prädiktion:**
* Hinzunahme von Prädiktoren
* Bessere Messungen
* Leistungsfähigere Modelle
* Modellierung von Wechselwirkungen
* Non-lineare Modellierung
* Hierarchische Modellierung

**Optimierung der Outcomes:**
* Differenzierte (multidimensionale) Outcomes
* Dynamische Outcomes
* Hochauflösende Outcomes (Zeitreihen)
* Reziproke Outcomes (Wechselwirkungen)
* Vernetzte Outcomes
]

---
class: top, left
### Responderanalyse 

#### Probleme gängiger Outcomes von Wirksamkeitsstudien

* Summenwerte

* Arbitäre Cutoffs

* Keine Informationen über unterschiedliches Timing im Therapieansprechen

* Gruppenbasierte Durchschnittsverläufe

* oft zu geringe zeitliche Auflösung für schwankende Phänomene

* Keine objektiven Verhaltensmaße

* Wechselwirkungen auf Symptombasis nicht berücksichtigt


---
class: top, left
### Units of Analysis

#### Problem 1: Summenwerte

.pull-left[

.center[
&lt;img src="bilder/dep1.png" width="700px" /&gt;
]
.pull-left[
.center[
&lt;img src="bilder/sum.png" width="200px" /&gt;
]
]
.pull-right[
.center[
&lt;br&gt;
&lt;img src="bilder/gif1.gif" width="800px" /&gt;
]
]
]

.pull-right[
.center[
&lt;img src="bilder/sideeffects.png" width="400px" /&gt;
]

* alle Symptome gehen gleichgewichtet ein (tau-Äquivalenz)

* Ignorieren behandlungsspezifischer Effekte
]

---
class: top, left
### Units of Analysis

#### Symptomcluster

.pull-left[
.pull-left[
.center[
&lt;img src="bilder/sum.png" width="200px" /&gt;
]
.center[
&lt;img src="bilder/symptomcluster1.png" width="200px" /&gt;
]
]
.pull-right[
.center[
&lt;br&gt;
&lt;img src="bilder/gif1.gif" width="800px" /&gt;
]
.center[
&lt;br&gt;&lt;br&gt;
&lt;img src="bilder/gif2.gif" width="800px" /&gt;
]
]
]

.pull-right[
.center[
&lt;img src="bilder/symptomcluster.png" width="400px" /&gt;
]
.center[
&lt;img src="bilder/symptomcluster3.png" width="400px" /&gt;
]
]

---
class: top, left
### Units of Analysis

#### Symptomcluster



Beispieldatensatz:


```r
head(data_cluster, 2)
```

```
##   Item1 Item2 Item3 Item4 Item5 Item6 Item7 Item8 Item9 Item10
## 1  3.44  4.93  3.08  3.79  2.27  1.85  3.49  2.01 -0.61   1.03
## 2  2.03  2.12  0.96  3.94  2.98  0.97  2.76  2.54  1.01   1.63
```

Beispielcode:


```r
# Transpose data
data_transposed = t(na.omit(data_cluster))
# Compute distance matrix
d = dist(data_transposed, method = "euclidean")
# Clustering
clust = hclust(d, method = "ward.D2")
# Create dendrogram
dend &lt;- as.dendrogram(clust, hang = -1)
# Prune dendrogram
pruned = dynamicTreeCut::cutreeDynamic(clust, distM = as.matrix(d), method = "hybrid", minClusterSize = 1)
```
---
class: top, left
### Units of Analysis

#### Symptomcluster: Beispielstudie

.center[
&lt;img src="bilder/Fig1.png" width="950px" /&gt;
]

---
class: top, left
### Units of Analysis

#### Problem 2: Arbitäre Cutoffs

.pull-left[
.center[
&lt;img src="bilder/gif1.gif" width="450px" /&gt;
]
]
.pull-right[
.center[
&lt;img src="bilder/respgif.gif" width="700px" /&gt;
]
]

* feste Definitionen für Behandlungserfolg z.B. Response `\(\geq\)` 50% Symptomreduktion

* Vorteil: ermöglicht leicht interpretierbare Subgruppenanalyse (Responder vs. Non-Responder)

---
class: top, left
### Units of Analysis

#### Problem 2: Arbitäre Cutoffs

.pull-left[
.center[
&lt;img src="bilder/respgif.gif" width="700px" /&gt;
]
]
.pull-right[
.center[
&lt;img src="bilder/resp.png" width="300px" /&gt;
]
]

* Nachteil: Cutoff ist arbiträr `\(\rightarrow\)` `\(\geq\)` 50% Symptomreduktion klinisch relevant?

* Nachteil: 49% Verbessung und 50% Verbessung unterschiedliche Kategorie; 50% und 99% gleich

---
class: top, left
### Units of Analysis

#### Problem 3: Keine Informationen über unterschiedliches Timing im Therapieansprechen

.pull-left[
.center[
&lt;img src="bilder/RCT2.png" width="700px" /&gt;
]
]
.pull-right[
.center[
&lt;img src="bilder/Timing.gif" width="700px" /&gt;
]
]

* Wirksamkeitsvergleich und Berechnung von Responderstatus i.d.R. zum Endpunkt der Studie

* Ignorieren frühen/späten Therapieansprechens 

* Keine Berücksichtigung der Dynamik von Subgruppen

---
class: top, left
### Units of Analysis

#### Response-Trajektorien: Mixture Modell

.pull-left[
1-Trajektorien-Ansatz
.center[
&lt;img src="bilder/gif4.gif" width="250px" /&gt;
]
Mixture-Modell
.center[
&lt;img src="bilder/gif5.gif" width="250px" /&gt;
]
]

.pull-right[
Durchschnittstrajektorie
.center[
&lt;img src="bilder/gif1.gif" width="250px" /&gt;
]
Durchschnittstrajektorie
.center[
&lt;img src="bilder/gif3.gif" width="250px" /&gt;
]
]

---
class: top, left
### Units of Analysis

#### Response-Trajektorien: Mixture Modell



.pull-left[
Beispieldatensatz:


```r
head(df, 10)
```

```
##    t id        y
## 1  1  1 22.16084
## 2  2  1 22.94598
## 3  3  1 21.40208
## 4  1  2 23.99123
## 5  2  2 18.57353
## 6  3  2 21.47158
## 7  1  3 23.25675
## 8  2  3 25.74629
## 9  3  3 19.46554
## 10 1  4 31.06219
```
]

.pull-left[
Beispielcode:


```r
mi = lcmm::hlme(fixed = y ~ 1 + t + I(t^2),
           mixture = ~ 1 + t + I(t^2),
           random = ~ 1,
           ng = 5,
           nwg = FALSE,
           idiag = FALSE,
           data = df,
           subject = "id")
```
]

---
class: top, left
### Units of Analysis

#### Response-Trajektorien: Beispielstudie

.center[
&lt;img src="bilder/Figure1_alternate.png" width="1000px" /&gt;
]

---
class: top, left
### Units of Analysis

#### Das Problem zu niedriger Auflösung bei schwankenden Konstrukten

.pull-left[

* Endpunkt-Messung stark Timing-abhängig

* Besondere Bedeutung bei BL-Prädiktoren

* Zeitfenster vs. Zeitpunkt

Fortschritt:

* EMA-Daten und Sensing ermöglichen zeitlich-verdichtete Messungen

* Probleme: 

  * große Datenmengen
  * wenig inferenzstatistische Konzepte
  * Power-Überlegungen

]
.pull-right[
.center[
&lt;img src="Folien_files/figure-html/unnamed-chunk-36-1.png" width="400px" /&gt;
]
]

---
class: top, left
### Units of Analysis

#### Time-Series Modeling - Dynamic Time Warping

.pull-left[
.center[
&lt;img src="bilder/dtw1.png" width="500px" /&gt;
]
]

.pull-right[
.center[
&lt;img src="bilder/dtw2.png" width="500px" /&gt;
]
]

---
class: top, left
### Units of Analysis

#### Time-Series Modeling - Dynamic Time Warping



Beispieldatensatz:


```r
head(ts_sim_df, 3)
```

```
##   nodep_V1 nodep_V2 nodep_V3 nodep_V4 nodep_V5   dep_V1   dep_V2   dep_V3   dep_V4   dep_V5
## 1 6.575727 5.225222 5.097103 9.042683 5.803125 7.673224 6.665698 5.249806 8.576838 6.446484
## 2 7.170461 6.053103 6.172585 8.913733 6.035214 5.952480 5.821827 6.890124 6.975446 9.118886
## 3 5.549862 5.560508 7.451713 9.563362 5.772214 6.054278 5.418546 7.456762 6.191524 7.299504
```

Beispielcode:


```r
dtwclust::tsclust(t(ts_sim_df),
                  type = "h",
                  k = 2,
                  distance = "dtw",
                  control = hierarchical_control(method = "complete"),
                  preproc = NULL,
                  args = tsclust_args(dist = list(window.size = 5L)))
```

---
class: top, left
### Units of Analysis

#### Time-Series Modeling - Dynamic Time Warping

.center[
&lt;img src="bilder/dtw4.png" width="900px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Latent-Growth Curve

.center[
&lt;img src="bilder/lgcm.png" width="500px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Latent-Growth Curve

.pull-left[
Beispieldatensatz:




```r
library(lavaan)
head(data, 4)
```

```
##      t1    t2    t3    t4    t5
## 1  1.73  2.14  2.77  2.52  2.52
## 2 -1.98 -4.40 -6.02 -7.03 -7.03
## 3  0.32 -1.27  1.56  2.87  2.87
## 4  0.78  3.53  3.14  5.36  5.36
```

Beispielcode:


```r
model &lt;- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4 + 1*t5
           s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4 + 4*t5'
fit &lt;- growth(model, data = data)
summary(fit)
```
]

.pull-right[
.center[
&lt;img src="bilder/lgcm.png" width="500px" /&gt;
]
]
---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Latent-Growth Mediation

.center[
&lt;img src="bilder/sem1.png" width="500px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Latent-Growth Mediation

Beispielcode:

.pull-left[

```r
model &lt;- '
iy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
sy =~ 0*y1 + 1*y2 + 2*y3 + 3*y4
ix =~ 1*x1 + 1*x2 + 1*x3 + 1*x4
sx =~ 0*x1 + 1*x2 + 2*x3 + 3*x4
im =~ 1*m1 + 1*m2 + 1*m3 + 1*m4
sm =~ 0*m1 + 1*m2 + 2*m3 + 3*m4

# direct effect
sy ~ c*sx
# mediator
sm ~ a*sx
sy ~ b*sm
# indirect effect (a*b)
ab := a*b
# total effect
total := c + (a*b)'
fit &lt;- sem(model, data = Data)
```
]
.pull-right[
.center[
&lt;img src="bilder/sem1.png" width="500px" /&gt;
]
]

---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Cross-lagged panel model

.center[
&lt;img src="bilder/sem2.png" width="700px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Strukturgleichungsmodelle: Cross-lagged panel model

Beispielcode:

.pull-left[

```r
cl_model = "
Cog_T4 ~ Cog_T3 + Func_T3
Func_T4 ~ Cog_T3 + Func_T3
Cog_T3 ~ Cog_T2 + Func_T2
Func_T3 ~ Cog_T2 + Func_T2
Cog_T2 ~ Cog_T1 + Func_T1
Func_T2 ~ Cog_T1 + Func_T1
Cog_T4 ~~ Func_T4
Cog_T3 ~~ Func_T3
Cog_T2 ~~ Func_T2
Cog_T1 ~~ Func_T1
"

fit &lt;-sem(cl_model, missing = "fiml", data = data)
summary(fit)
```
]
.pull-right[
.center[
&lt;img src="bilder/sem2.png" width="500px" /&gt;
]
]
---
class: top, left
### Multivariate patterns

#### Netzwerkanalyse

.center[
&lt;img src="bilder/network1.png" width="500px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Netzwerkanalyse

.center[
&lt;img src="bilder/network2.png" width="700px" /&gt;
]

---
class: top, left
### Multivariate patterns

#### Netzwerkanalyse

.center[
&lt;img src="bilder/network3.png" width="500px" /&gt;
]

---
class: top, left
### Take-aways

.full-width[.content-box-gray[


]
]

[**Link zur Wissensüberprüfung**](https://docs.google.com/forms/d/e/1FAIpQLSfAAWpZWqxU4Bw5LzVFRtYo7RvCIt4BRAEWCHx6XvlePfEQzw/viewform?usp=sf_link)

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
